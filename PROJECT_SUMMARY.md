# DairyFarm Insight - プロジェクト概要

## 実装完了機能

### 認証・認可
- ✅ ユーザー登録・ログイン機能
- ✅ ロールベースアクセス制御（Owner, Staff, Accountant）
- ✅ Row Level Security (RLS) によるデータ分離
- ✅ 自動プロファイル作成（初回ログイン時）

### 収益管理
- ✅ 収益登録（手動入力）
- ✅ 収益一覧表示
- ✅ 収益編集・削除
- ✅ 収益種別：牛乳、枝肉、子牛、その他、補助金
- ✅ 顧客名・備考の記録

### 支出管理
- ✅ 支出登録（手動入力）
- ✅ 支出一覧表示
- ✅ 支出編集・削除
- ✅ 11種類の支出カテゴリ
- ✅ 業者名・備考の記録

### 畜群管理
- ✅ 畜群登録・一覧表示
- ✅ 畜群削除
- ✅ 家畜種別管理（乳牛、肉牛、その他）

### 補助金・助成金管理
- ✅ 補助金登録・一覧表示
- ✅ 申請期限・支払日管理
- ✅ ステータス管理（申請済み、承認済み、支払済み、却下）
- ✅ 予定額・実績額の追跡

### ダッシュボード
- ✅ 今月の利益表示
- ✅ 前月比の計算・表示
- ✅ 今月の収益・支出サマリー
- ✅ 最近の収益・支出一覧
- ✅ 期限が近い補助金アラート

### 会計出力
- ✅ CSVエクスポート機能
- ✅ 期間指定エクスポート
- ✅ 会計ソフト対応フォーマット

### データベース
- ✅ 正規化されたマスターデータ設計
- ✅ トランザクションテーブル設計
- ✅ 月次利益計算ビュー（monthly_profit）
- ✅ 頭当たり利益計算ビュー（profit_per_animal）
- ✅ 自動更新タイムスタンプ

## 技術スタック

### フロントエンド
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- React Server Components

### バックエンド
- Supabase (PostgreSQL)
- Supabase Auth
- Row Level Security

### UIコンポーネント
- カスタムコンポーネント（shadcn/uiスタイル）
- レスポンシブデザイン

## ファイル構造

```
Caw/
├── app/                    # Next.js App Router
│   ├── auth/              # 認証ページ
│   ├── dashboard/         # ダッシュボード
│   ├── revenue/           # 収益管理
│   ├── expenses/          # 支出管理
│   ├── herds/             # 畜群管理
│   ├── subsidies/         # 補助金管理
│   └── accounting/        # 会計出力
├── components/            # Reactコンポーネント
│   ├── ui/               # UIコンポーネント
│   ├── layout/           # レイアウトコンポーネント
│   ├── revenue/           # 収益関連コンポーネント
│   ├── expenses/          # 支出関連コンポーネント
│   ├── herds/            # 畜群関連コンポーネント
│   └── subsidies/        # 補助金関連コンポーネント
├── lib/                   # ユーティリティ
│   ├── supabase/         # Supabaseクライアント
│   └── utils.ts          # 共通ユーティリティ
├── supabase/              # データベース
│   └── migrations/        # SQLマイグレーション
└── types/                 # TypeScript型定義
```

## セキュリティ機能

1. **Row Level Security (RLS)**
   - すべてのテーブルで有効
   - ユーザーは自分の農場のデータのみアクセス可能

2. **ロールベースアクセス制御**
   - Owner: すべての操作が可能
   - Staff: データ入力と閲覧が可能
   - Accountant: 閲覧とエクスポートのみ可能

3. **認証**
   - Supabase Authによる安全な認証
   - セッション管理

## 次のステップ（未実装機能）

### MVP範囲外（将来の拡張）
- [ ] OCR機能によるレシート自動入力
- [ ] CSVインポート機能
- [ ] 補助金自動推奨機能
- [ ] 高度な分析・レポート機能
- [ ] モバイルアプリ
- [ ] 多言語対応
- [ ] 通知機能

### 改善点
- [ ] エラーハンドリングの強化
- [ ] ローディング状態の改善
- [ ] データ検証の強化
- [ ] テストの追加
- [ ] パフォーマンス最適化

## 使用方法

1. Supabaseプロジェクトを作成
2. 環境変数を設定（.env.local）
3. データベースマイグレーションを実行
4. `npm install` で依存関係をインストール
5. `npm run dev` で開発サーバーを起動

詳細は `SETUP.md` を参照してください。

## ライセンス

このプロジェクトはプライベートプロジェクトです。


